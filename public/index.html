<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Joytan Public</title>

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/6.4.1/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/6.4.1/firebase-auth.js"></script>
  <script defer src="/__/firebase/6.4.1/firebase-database.js"></script>
  <script defer src="/__/firebase/6.4.1/firebase-messaging.js"></script>
  <script defer src="/__/firebase/6.4.1/firebase-storage.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script defer src="/__/firebase/init.js"></script>

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- JQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <!-- For popup? -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>

  <!-- For accordion -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">


  <script src="/js/addAudio.js"></script>
  <script src="/js/addProjectBtn.js"></script>
  <link rel="stylesheet" href="css/main.css">

  <script type="text/javascript">
    window.onload = () => {
      const storage = firebase.storage();
      const storageRef = storage.ref();
      const topProjectsRef = storageRef.child('projects');
      const structureRef = storageRef.child('projects_structure.json');
      var structureData;

      structureRef.getDownloadURL().then(function(url) {
        $.getJSON(url, function(data) {
          loadProjects(data, topProjectsRef);
        })
      })
    }
    function loadProjects(structureJson, topRef) {
      topRef.listAll().then(res => {
        res.prefixes.forEach(projectRef => {
          addProjectBtn(structureJson[projectRef.name], projectRef);
        })
      })
    }
  </script>

</head>

<body>
  <div class="row justify-content-center">
    <div class="col-12">
      <div class="container">
        <h2 class="mt-2">Joytan Public</h2>
        <hr />
        <div class="accordion" id="projectsTop">
        </div>
      </div>
    </div>


    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyBr9SLxhKfyxzsbVmCVcn-J_QCgHQOqrOY",
        authDomain: "joytan-rec-16ba2.firebaseapp.com",
        databaseURL: "https://joytan-rec-16ba2.firebaseio.com",
        projectId: "joytan-rec-16ba2",
        storageBucket: "joytan-rec-16ba2.appspot.com",
        messagingSenderId: "950782104164",
        appId: "1:950782104164:web:adccd0fa64ae91ac"
      };
      firebase.initializeApp(firebaseConfig);
    </script>
</body>

</html>
